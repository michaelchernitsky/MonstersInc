2020-08-15 15:01:34.824 +03:00 [INF] Starting IdentityServer4 version 3.0.1.0
2020-08-15 15:01:35.839 +03:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-15 15:01:35.849 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-08-15 15:01:35.855 +03:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-08-15 15:01:35.860 +03:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-08-15 15:01:35.862 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-08-15 15:01:35.865 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-08-15 15:01:36.348 +03:00 [DBG] Starting grant removal
2020-08-15 15:01:36.420 +03:00 [DBG] Login Url: /Account/Login
2020-08-15 15:01:36.423 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-08-15 15:01:36.426 +03:00 [DBG] Logout Url: /Account/Logout
2020-08-15 15:01:36.427 +03:00 [DBG] ConsentUrl Url: /consent
2020-08-15 15:01:36.429 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2020-08-15 15:01:36.430 +03:00 [DBG] Error Url: /home/error
2020-08-15 15:01:36.432 +03:00 [DBG] Error Id Parameter: errorId
2020-08-15 15:02:07.297 +03:00 [INF] Removing 0 grants
2020-08-15 15:02:37.379 +03:00 [INF] Removing 0 grants
2020-08-15 15:03:07.394 +03:00 [INF] Removing 0 grants
2020-08-15 15:03:07.438 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-08-15 15:03:07.445 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-08-15 15:03:07.447 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-08-15 15:03:07.450 +03:00 [DBG] Start authorize request
2020-08-15 15:03:07.458 +03:00 [DBG] No user present in authorize request
2020-08-15 15:03:07.461 +03:00 [DBG] Start authorize request protocol validation
2020-08-15 15:03:07.474 +03:00 [DBG] client configuration validation for client demo_api_swagger succeeded.
2020-08-15 15:03:07.488 +03:00 [DBG] Checking for PKCE parameters
2020-08-15 15:03:07.518 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-08-15 15:03:07.558 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"demo_api_swagger","ClientName":"Swagger UI for demo_api","RedirectUri":"https://localhost:44361/swagger/oauth2-redirect.html","AllowedRedirectUris":["https://localhost:44361/swagger/oauth2-redirect.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"api1","State":"U2F0IEF1ZyAxNSAyMDIwIDE1OjAzOjA3IEdNVCswMzAwIChJc3JhZWwgRGF5bGlnaHQgVGltZSk=","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"response_type":"code","client_id":"demo_api_swagger","redirect_uri":"https://localhost:44361/swagger/oauth2-redirect.html","scope":"api1","state":"U2F0IEF1ZyAxNSAyMDIwIDE1OjAzOjA3IEdNVCswMzAwIChJc3JhZWwgRGF5bGlnaHQgVGltZSk=","code_challenge":"9fynFcvOI8OkG5wt6zG6O3GVmOD912WhnR39ZKoyrWI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2020-08-15 15:03:07.565 +03:00 [INF] Showing login: User is not authenticated
2020-08-15 15:03:07.608 +03:00 [DBG] Start authorize request protocol validation
2020-08-15 15:03:07.610 +03:00 [DBG] client configuration validation for client demo_api_swagger succeeded.
2020-08-15 15:03:07.611 +03:00 [DBG] Checking for PKCE parameters
2020-08-15 15:03:07.613 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-08-15 15:03:07.617 +03:00 [DBG] client configuration validation for client demo_api_swagger succeeded.
2020-08-15 15:03:36.328 +03:00 [DBG] Start authorize request protocol validation
2020-08-15 15:03:36.330 +03:00 [DBG] client configuration validation for client demo_api_swagger succeeded.
2020-08-15 15:03:36.332 +03:00 [DBG] Checking for PKCE parameters
2020-08-15 15:03:36.334 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-08-15 15:03:36.371 +03:00 [DBG] Augmenting SignInContext
2020-08-15 15:03:36.373 +03:00 [DBG] Adding idp claim with value: local
2020-08-15 15:03:36.374 +03:00 [DBG] Adding amr claim with value: pwd
2020-08-15 15:03:36.401 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-08-15 15:03:36.403 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-08-15 15:03:36.404 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-08-15 15:03:36.408 +03:00 [DBG] Start authorize callback request
2020-08-15 15:03:36.411 +03:00 [DBG] User in authorize request: 5f924200-92f9-4d00-aa11-5243f727632d
2020-08-15 15:03:36.413 +03:00 [DBG] Start authorize request protocol validation
2020-08-15 15:03:36.415 +03:00 [DBG] client configuration validation for client demo_api_swagger succeeded.
2020-08-15 15:03:36.417 +03:00 [DBG] Checking for PKCE parameters
2020-08-15 15:03:36.419 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-08-15 15:03:36.421 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"demo_api_swagger","ClientName":"Swagger UI for demo_api","RedirectUri":"https://localhost:44361/swagger/oauth2-redirect.html","AllowedRedirectUris":["https://localhost:44361/swagger/oauth2-redirect.html"],"SubjectId":"5f924200-92f9-4d00-aa11-5243f727632d","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"api1","State":"U2F0IEF1ZyAxNSAyMDIwIDE1OjAzOjA3IEdNVCswMzAwIChJc3JhZWwgRGF5bGlnaHQgVGltZSk=","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"Rl36x7RlXkRywfqytV21Vw","Raw":{"response_type":"code","client_id":"demo_api_swagger","redirect_uri":"https://localhost:44361/swagger/oauth2-redirect.html","scope":"api1","state":"U2F0IEF1ZyAxNSAyMDIwIDE1OjAzOjA3IEdNVCswMzAwIChJc3JhZWwgRGF5bGlnaHQgVGltZSk=","code_challenge":"9fynFcvOI8OkG5wt6zG6O3GVmOD912WhnR39ZKoyrWI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2020-08-15 15:03:36.699 +03:00 [DBG] op2oDkctUTu8A2pJNM0jXg+rG5ihXjgIu1jMo6zet68= found in database: true
2020-08-15 15:03:36.748 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2020-08-15 15:03:36.753 +03:00 [DBG] Creating Authorization Code Flow response.
2020-08-15 15:03:36.786 +03:00 [DBG] hhnGYGxaTBE/caducQFEwFoQYtXHYmimEWTtG0dtVg0= not found in database
2020-08-15 15:03:36.814 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"5f924200-92f9-4d00-aa11-5243f727632d","ClientId":"demo_api_swagger","RedirectUri":"https://localhost:44361/swagger/oauth2-redirect.html","State":"U2F0IEF1ZyAxNSAyMDIwIDE1OjAzOjA3IEdNVCswMzAwIChJc3JhZWwgRGF5bGlnaHQgVGltZSk=","Scope":"api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-08-15 15:03:36.824 +03:00 [DBG] Augmenting SignInContext
2020-08-15 15:03:36.938 +03:00 [DBG] CORS request made for path: /connect/token from origin: https://localhost:44361
2020-08-15 15:03:36.943 +03:00 [DBG] Client list checked and origin: https://localhost:44361 is allowed
2020-08-15 15:03:36.945 +03:00 [DBG] CorsPolicyService allowed origin: https://localhost:44361
2020-08-15 15:03:36.978 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-08-15 15:03:36.988 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-08-15 15:03:36.990 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-08-15 15:03:36.995 +03:00 [DBG] Start token request.
2020-08-15 15:03:36.998 +03:00 [DBG] Start client validation
2020-08-15 15:03:37.003 +03:00 [DBG] Start parsing Basic Authentication secret
2020-08-15 15:03:37.006 +03:00 [DBG] Start parsing for secret in post body
2020-08-15 15:03:37.008 +03:00 [DBG] Parser found secret: PostBodySecretParser
2020-08-15 15:03:37.010 +03:00 [DBG] Secret id found: demo_api_swagger
2020-08-15 15:03:37.012 +03:00 [DBG] client configuration validation for client demo_api_swagger succeeded.
2020-08-15 15:03:37.014 +03:00 [DBG] Public Client - skipping secret validation success
2020-08-15 15:03:37.015 +03:00 [DBG] Client validation success
2020-08-15 15:03:37.020 +03:00 [DBG] Start token request validation
2020-08-15 15:03:37.025 +03:00 [DBG] Start validation of authorization code token request
2020-08-15 15:03:37.033 +03:00 [DBG] hhnGYGxaTBE/caducQFEwFoQYtXHYmimEWTtG0dtVg0= found in database: true
2020-08-15 15:03:37.070 +03:00 [DBG] removing hhnGYGxaTBE/caducQFEwFoQYtXHYmimEWTtG0dtVg0= persisted grant from database
2020-08-15 15:03:37.095 +03:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2020-08-15 15:03:37.114 +03:00 [DBG] Validation of authorization code token request success
2020-08-15 15:03:37.123 +03:00 [INF] Token request validation success, {"ClientId":"demo_api_swagger","ClientName":"Swagger UI for demo_api","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"OGrOPZg_ch2OkBuohPX-AbfhL_23KaYl5y9hsc4NonQ","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"OGrOPZg_ch2OkBuohPX-AbfhL_23KaYl5y9hsc4NonQ","client_id":"demo_api_swagger","client_secret":"***REDACTED***","redirect_uri":"https://localhost:44361/swagger/oauth2-redirect.html","code_verifier":"W9VOyq3dzx2ky94AD-B8K0D7Phnjx3zQrf8mbqPZBPw"},"$type":"TokenRequestValidationLog"}
2020-08-15 15:03:37.131 +03:00 [DBG] client configuration validation for client demo_api_swagger succeeded.
2020-08-15 15:03:37.142 +03:00 [DBG] Getting claims for access token for client: demo_api_swagger
2020-08-15 15:03:37.144 +03:00 [DBG] Getting claims for access token for subject: 5f924200-92f9-4d00-aa11-5243f727632d
2020-08-15 15:03:37.410 +03:00 [INF] Removing 0 grants
2020-08-15 15:03:37.432 +03:00 [DBG] Token request success.
2020-08-15 15:03:44.321 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-08-15 15:03:44.325 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-08-15 15:03:44.328 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-08-15 15:03:44.334 +03:00 [DBG] Start discovery request
2020-08-15 15:03:44.552 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-08-15 15:03:44.555 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-08-15 15:03:44.556 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-08-15 15:03:44.559 +03:00 [DBG] Start key discovery request
2020-08-15 15:04:07.428 +03:00 [INF] Removing 0 grants
2020-08-15 15:04:37.458 +03:00 [INF] Removing 0 grants
2020-08-15 15:05:07.480 +03:00 [INF] Removing 0 grants
2020-08-15 15:05:37.490 +03:00 [INF] Removing 0 grants
